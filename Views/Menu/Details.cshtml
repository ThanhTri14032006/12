@model RestaurantMVC.Models.MenuItem
@{
    ViewData["Title"] = Model?.Name ?? "Chi tiết món ăn";
}

@if (Model != null)
{
    <div class="container py-5">
        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="@Url.Action("Index", "Home")">Trang chủ</a></li>
                <li class="breadcrumb-item"><a href="@Url.Action("Index", "Menu")">Thực đơn</a></li>
                <li class="breadcrumb-item active">@Model.Name</li>
            </ol>
        </nav>

        <div class="row">
            <!-- Image Section -->
            <div class="col-lg-6 mb-4">
                <div class="position-relative">
                    <img src="@(string.IsNullOrEmpty(Model.ImageUrl) ? "https://via.placeholder.com/600x400?text=" + Uri.EscapeDataString(Model.Name) : Model.ImageUrl)" 
                         class="img-fluid rounded shadow" alt="@Model.Name" style="width: 100%; height: 400px; object-fit: cover;">
                    @if (!Model.IsAvailable)
                    {
                        <div class="position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center rounded" 
                             style="background: rgba(0,0,0,0.7);">
                            <span class="badge bg-danger fs-4">Hết món</span>
                        </div>
                    }
                    <div class="position-absolute top-0 end-0 m-3">
                        <span class="badge bg-primary fs-6">@Model.Category</span>
                    </div>
                </div>
            </div>

            <!-- Details Section -->
            <div class="col-lg-6">
                <div class="h-100 d-flex flex-column">
                    <div class="mb-4">
                        <h1 class="display-5 fw-bold mb-3">@Model.Name</h1>
                        <div class="d-flex align-items-center mb-3">
                            <span class="h2 text-primary me-3">@Model.Price.ToString("N0") VNĐ</span>
                            @if (Model.IsAvailable)
                            {
                                <span class="badge bg-success fs-6">Còn món</span>
                            }
                            else
                            {
                                <span class="badge bg-danger fs-6">Hết món</span>
                            }
                        </div>
                    </div>

                    <div class="mb-4">
                        <h5 class="fw-bold mb-3">Mô tả món ăn</h5>
                        <p class="lead">@Model.Description</p>
                    </div>

                    <div class="mb-4">
                        <h5 class="fw-bold mb-3">Thông tin chi tiết</h5>
                        <div class="row">
                            <div class="col-sm-6 mb-2">
                                <strong>Danh mục:</strong> @Model.Category
                            </div>
                            <div class="col-sm-6 mb-2">
                                <strong>Trạng thái:</strong> 
                                @if (Model.IsAvailable)
                                {
                                    <span class="text-success">Còn món</span>
                                }
                                else
                                {
                                    <span class="text-danger">Hết món</span>
                                }
                            </div>
                            <div class="col-sm-6 mb-2">
                                <strong>Ngày tạo:</strong> @Model.CreatedAt.ToString("dd/MM/yyyy")
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="mt-auto">
                        <div class="d-flex gap-3 mb-3">
                            <a href="@Url.Action("Index", "Booking")" class="btn btn-primary btn-lg flex-fill">
                                <i class="fas fa-calendar-alt me-2"></i>Đặt bàn ngay
                            </a>
                            <a href="@Url.Action("Index", "Menu")" class="btn btn-outline-secondary btn-lg">
                                <i class="fas fa-arrow-left me-2"></i>Quay lại
                            </a>
                        </div>
                        
                        <!-- Share Buttons -->
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-primary btn-sm" onclick="shareOnFacebook()">
                                <i class="fab fa-facebook-f me-1"></i>Chia sẻ
                            </button>
                            <button class="btn btn-outline-info btn-sm" onclick="copyLink()">
                                <i class="fas fa-link me-1"></i>Sao chép link
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Related Items Section -->
        <div class="row mt-5">
            <div class="col-12">
                <h3 class="fw-bold mb-4">Món ăn cùng danh mục</h3>
                <div class="text-center py-4">
                    <p class="text-muted">Các món ăn khác trong danh mục "@Model.Category" sẽ được hiển thị tại đây</p>
                    <a href="@Url.Action("Index", "Menu", new { category = Model.Category })" class="btn btn-primary">
                        <i class="fas fa-eye me-2"></i>Xem tất cả món @Model.Category
                    </a>
                </div>
            </div>
        </div>

        <!-- Recommendation Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="bg-light p-4 rounded">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h5 class="fw-bold mb-2">Thích món này?</h5>
                            <p class="mb-0">Đặt bàn ngay để thưởng thức @Model.Name cùng với những món ăn tuyệt vời khác!</p>
                        </div>
                        <div class="col-md-4 text-md-end">
                            <a href="@Url.Action("Index", "Booking")" class="btn btn-warning btn-lg">
                                <i class="fas fa-calendar-alt me-2"></i>Đặt bàn
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
else
{
    <div class="container py-5">
        <div class="text-center">
            <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
            <h2>Không tìm thấy món ăn</h2>
            <p class="text-muted">Món ăn bạn đang tìm kiếm không tồn tại hoặc đã bị xóa.</p>
            <a href="@Url.Action("Index", "Menu")" class="btn btn-primary">
                <i class="fas fa-arrow-left me-2"></i>Quay lại thực đơn
            </a>
        </div>
    </div>
}

<script>
function shareOnFacebook() {
    const url = encodeURIComponent(window.location.href);
    const title = encodeURIComponent('@Model?.Name - Restaurantly');
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&t=${title}`, '_blank', 'width=600,height=400');
}

function copyLink() {
    navigator.clipboard.writeText(window.location.href).then(function() {
        alert('Đã sao chép link vào clipboard!');
    }, function(err) {
        console.error('Không thể sao chép link: ', err);
    });
}
</script>